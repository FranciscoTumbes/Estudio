<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üß† Desaf√≠o Exponencial Avanzado</title>
   
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <style>
        /* Estilos personalizados */
        body { 
            background-color: #e6e6fa; /* Lavanda claro */
            padding-bottom: 50px;
        }
        .juego-container { 
            max-width: 700px; /* Un poco m√°s grande para problemas complejos */
            margin-top: 40px; 
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.2);
        }
        .expresion { 
            font-size: 2.2rem; 
            font-weight: bold; 
            margin: 20px 0;
            font-family: 'Courier New', Courier, monospace;
            min-height: 80px; 
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1.2;
        }
        .resultado-texto { 
            font-size: 1.2rem; 
            font-weight: 500;
        }
        .super-indice {
            font-size: 0.6em;
            vertical-align: super;
            margin-left: -0.1em; /* Ajuste visual */
        }
        .card-header-custom {
            background-color: #8a2be2; /* Azul violeta */
            color: white;
            font-weight: bold;
        }
        /* Estilos para fracciones dentro de la expresi√≥n */
        .fraccion-linea {
            border-bottom: 2px solid #333;
            display: inline-block;
            padding: 0 5px 3px;
        }
    </style>
</head>
<body>

    <div class="container juego-container shadow p-4 bg-white rounded">
        <h1 class="text-center text-primary mb-4">üß† Desaf√≠o Exponencial Avanzado</h1>
        <h1 class="text-center text-primary mb-4"> www.CpiGestor.com</h1>
        <p class="text-center text-secondary">Aplica varias leyes, incluyendo exponentes negativos. Simplifica a la **forma de potencia final** (ej: 2^-1) o al **valor num√©rico/fraccionario** (ej: 1/2).</p>
        
        <div class="alert alert-info text-center" role="alert">
            <span id="puntuacion">Puntuaci√≥n: 0</span>
        </div>

        <div id="area-juego" class="text-center">
            
            <div class="card mb-4 border-info">
                <div class="card-header-custom">
                    <span id="propiedad-nombre">Propiedad: Combinada</span>
                </div>
                <div class="card-body">
                    <p class="resultado-texto text-muted">Simplifica o calcula el valor:</p>
                    <div id="expresion-a-resolver" class="expresion text-dark"></div>
                </div>
            </div>

            <div class="input-group mb-3">
                <span class="input-group-text bg-light">Respuesta:</span>
                <input type="text" class="form-control" id="respuesta-usuario" placeholder="Ejemplo: 2^-1, 1/2, o 4">
            </div>

            <button class="btn btn-warning btn-lg w-100 mb-3" onclick="verificarRespuesta()">
                ¬°Comprobar! üîç
            </button>

            <div id="feedback" class="resultado-texto mt-3"></div>

        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        // L√≥gica del Juego (JavaScript)
        let puntuacion = 0;
        let problemaActual = {};
        
        // Funci√≥n para renderizar una expresi√≥n con super√≠ndices (a^b -> a·µá)
        function renderExponente(base, exponente) {
            return `${base}<span class="super-indice">${exponente}</span>`;
        }
        
        // Funci√≥n para obtener la forma fraccionaria si el exponente es negativo
        function calcularFraccion(base, exp) {
            if (exp < 0) {
                const denominador = base ** Math.abs(exp);
                return `1/${denominador}`;
            }
            return String(base ** exp);
        }

        // Propiedades de exponentes (problemas m√°s complejos)
        const PROPIEDADES = [
            { 
                id: 1, 
                nombre: "Producto y Cociente (Combinado)", 
                generar: () => {
                    const base = Math.floor(Math.random() * 2) + 2; // Base 2 o 3
                    const exp1 = Math.floor(Math.random() * 3) + 4; // Exponente 4 a 6
                    const exp2 = Math.floor(Math.random() * 2) + 2; // Exponente 2 o 3
                    const exp3 = Math.floor(Math.random() * 3) + 5; // Exponente 5 a 7
                    
                    const expresion = `( ${renderExponente(base, exp1)} ‚ãÖ ${renderExponente(base, exp2)} ) / ${renderExponente(base, exp3)}`;
                    
                    const expFinal = exp1 + exp2 - exp3;
                    const simplificada = `${base}^${expFinal}`;
                    const respuestaNumericaOFraccionaria = calcularFraccion(base, expFinal);

                    return { expresion, respuesta: respuestaNumericaOFraccionaria, simplificada: simplificada };
                }
            },
            { 
                id: 2, 
                nombre: "Exponente Negativo (a‚Åª‚Åø = 1/a‚Åø)", 
                generar: () => {
                    const base = Math.floor(Math.random() * 2) + 2; // Base 2 o 3
                    const exp = Math.floor(Math.random() * 2) + 2; // Exponente -2 o -3
                    const expNeg = -exp;
                    
                    const expresion = `${renderExponente(base, expNeg)}`;
                    const simplificada = `${base}^${expNeg}`;
                    const respuestaNumericaOFraccionaria = `1/${base ** exp}`;

                    return { expresion, respuesta: respuestaNumericaOFraccionaria, simplificada: simplificada };
                }
            },
            { 
                id: 3, 
                nombre: "Potencia de Cociente y Negativo (Combinado)", 
                generar: () => {
                    const base1 = Math.floor(Math.random() * 2) + 2; // Base 2 o 3
                    const base2 = Math.floor(Math.random() * 2) + 4; // Base 4 o 5
                    const exp = -1; 
                    
                    // (a/b)‚Åª¬π = b/a
                    const expresion = `(${base1} / ${base2})<span class="super-indice">${exp}</span>`; 
                    const respuestaNumericaOFraccionaria = `${base2}/${base1}`;

                    return { expresion, respuesta: respuestaNumericaOFraccionaria };
                }
            },
            { 
                id: 4, 
                nombre: "Doble Potencia y Producto", 
                generar: () => {
                    const base = Math.floor(Math.random() * 2) + 2; // Base 2 o 3
                    const exp1 = Math.floor(Math.random() * 2) + 1; // Exp 1 o 2
                    const exp2 = Math.floor(Math.random() * 2) + 1; // Exp 1 o 2
                    const exp3 = Math.floor(Math.random() * 3) + 3; // Exp 3 a 5
                    
                    // (a^m)^n * a^p
                    const expresion = `(${renderExponente(base, exp1)})<span class="super-indice">${exp2}</span> ‚ãÖ ${renderExponente(base, exp3)}`;
                    
                    const expFinal = (exp1 * exp2) + exp3;
                    const simplificada = `${base}^${expFinal}`;
                    const respuestaNumericaOFraccionaria = String(base ** expFinal);

                    return { expresion, respuesta: respuestaNumericaOFraccionaria, simplificada: simplificada };
                }
            },
            { 
                id: 5, 
                nombre: "Simplificaci√≥n a Exponente Negativo", 
                generar: () => {
                    const base = Math.floor(Math.random() * 2) + 3; // Base 3 o 4
                    const exp1 = Math.floor(Math.random() * 3) + 2; // Exp 2 a 4
                    const exp2 = Math.floor(Math.random() * 3) + 5; // Exp 5 a 7
                    
                    // a^m / a^n donde m < n
                    const expresion = `${renderExponente(base, exp1)} / ${renderExponente(base, exp2)}`;
                    
                    const expFinal = exp1 - exp2; // Ser√° negativo
                    const simplificada = `${base}^${expFinal}`;
                    const respuestaNumericaOFraccionaria = calcularFraccion(base, expFinal);

                    return { expresion, respuesta: respuestaNumericaOFraccionaria, simplificada: simplificada };
                }
            }
        ];

        // Funci√≥n principal para generar un nuevo problema
        function generarNuevoProblema() {
            const indicePropiedad = Math.floor(Math.random() * PROPIEDADES.length);
            const propiedadSeleccionada = PROPIEDADES[indicePropiedad];

            problemaActual = propiedadSeleccionada.generar();

            // Mostrar en la interfaz
            document.getElementById('expresion-a-resolver').innerHTML = problemaActual.expresion;
            document.getElementById('propiedad-nombre').innerText = `Propiedad: ${propiedadSeleccionada.nombre}`;
            document.getElementById('respuesta-usuario').value = ''; 
            document.getElementById('feedback').className = 'resultado-texto mt-3'; 
            document.getElementById('feedback').innerText = '¬°Aceptamos la forma simplificada o el valor final!';
        }

        // Funci√≥n para verificar la respuesta del usuario
        function verificarRespuesta() {
            const respuestaUsuario = document.getElementById('respuesta-usuario').value.trim();
            const feedbackDiv = document.getElementById('feedback');
            let esCorrecta = false;
            
            // Normalizar las respuestas (quitar espacios, pasar a min√∫sculas)
            const respuestaNormalizada = respuestaUsuario.toLowerCase().replace(/\s/g, '');
            
            // 1. Respuesta Num√©rica/Fraccionaria
            const respuestaCorrectaValor = problemaActual.respuesta.toLowerCase().replace(/\s/g, '');
            
            // 2. Respuesta Simplificada (Ej: 2^-3)
            const respuestaCorrectaSimplificada = problemaActual.simplificada ? problemaActual.simplificada.toLowerCase().replace(/\s/g, '') : '';
            
            // Comprobaci√≥n
            if (respuestaNormalizada === respuestaCorrectaValor) {
                esCorrecta = true;
            } else if (problemaActual.simplificada && respuestaNormalizada === respuestaCorrectaSimplificada) {
                esCorrecta = true;
            }

            if (esCorrecta) {
                puntuacion += 15; // M√°s puntos por ser m√°s dif√≠cil
                feedbackDiv.innerText = '¬°Fenomenal! ‚úÖ ¬°15 puntos! Siguiente reto...';
                feedbackDiv.className = 'resultado-texto mt-3 text-success';
                setTimeout(generarNuevoProblema, 1500); 
            } else {
                puntuacion = Math.max(0, puntuacion - 8); // Mayor penalizaci√≥n
                
                let mensaje = 'Incorrecto. ‚ùå ¬°Revisa tus leyes! ';
                
                let simplificadaTexto = problemaActual.simplificada ? ` (${problemaActual.simplificada})` : '';
                mensaje += `La respuesta correcta es ${problemaActual.respuesta}${simplificadaTexto}.`;
                
                feedbackDiv.innerText = mensaje;
                feedbackDiv.className = 'resultado-texto mt-3 text-danger';
            }

            // Actualizar la puntuaci√≥n
            document.getElementById('puntuacion').innerText = `Puntuaci√≥n: ${puntuacion}`;
        }

        // Iniciar el juego al cargar la p√°gina
        window.onload = generarNuevoProblema;

        // Permitir presionar "Enter" para verificar
        document.getElementById('respuesta-usuario').addEventListener('keypress', function (e) {
            if (e.key === 'Enter') {
                verificarRespuesta();
            }
        });
    </script>
</body>
</html>